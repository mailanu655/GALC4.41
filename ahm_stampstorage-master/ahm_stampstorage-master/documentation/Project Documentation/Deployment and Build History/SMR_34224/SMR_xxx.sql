ALTER TABLE "STAMPSTOR"."ALARMS_DEFINITION_TBX" (
  ADD COLUMN "ACTIVE"	SMALLINT,
  "AUTO_ARCHIVE_TIME"	DOUBLE,
  "NOTIFICATION_REQUIRED"	SMALLINT
); 

CREATE TABLE "STAMPSTOR"."CONTACT_TBX" (
  "CONTACT_ID"	BIGINT	NOT NULL	GENERATED BY DEFAULT
    AS IDENTITY (START WITH 1, INCREMENT BY 1, CACHE 20,
       NO MINVALUE, NO MAXVALUE, NO CYCLE, NO ORDER),
  "CONTACT_NAME"	VARCHAR(255)	NOT NULL,
  "EMAIL_ADDRESS"	VARCHAR(255)	NOT NULL,
  "PAGER_NUMBER"	VARCHAR(255)	NOT NULL,
  "VERSION"	INTEGER
);

ALTER TABLE "STAMPSTOR"."CONTACT_TBX"
  ADD PRIMARY KEY
    ("CONTACT_ID");
	
CREATE TABLE "STAMPSTOR"."ALARM_CONTACT_TBX" (
  "ALARM_CONTACT_ID"	BIGINT	NOT NULL	GENERATED BY DEFAULT
    AS IDENTITY (START WITH 1, INCREMENT BY 1, CACHE 20,
       NO MINVALUE, NO MAXVALUE, NO CYCLE, NO ORDER),
  "CONTACT_TYPE"	INTEGER	NOT NULL,
  "VERSION"	INTEGER,
  "ALARM"	BIGINT	NOT NULL,
  "CONTACT"	BIGINT	NOT NULL
);

ALTER TABLE "STAMPSTOR"."ALARM_CONTACT_TBX"
  ADD PRIMARY KEY
    ("ALARM_CONTACT_ID");
	
ALTER TABLE "STAMPSTOR"."ALARM_EVENT_TBX" (
ADD COLUMN  "CLEARED"	SMALLINT,
  "CLEARED_BY"	VARCHAR(255),
  "CLEARED_TIMESTAMP"	TIMESTAMP,
  "NOTIFIED"	SMALLINT
);	
	
CREATE TABLE "STAMPSTOR"."ALARM_EVENT_ARCHIVE_TBX" (
  "ALARM_EVENT_ARCHIVE_ID"	BIGINT	NOT NULL	GENERATED BY DEFAULT
    AS IDENTITY (START WITH 1, INCREMENT BY 1, CACHE 20,
       NO MINVALUE, NO MAXVALUE, NO CYCLE, NO ORDER),
  "ALARM_EVENT_ID"	BIGINT	NOT NULL,
  "ALARM_NUMBER"	INTEGER	NOT NULL,
  "ARCHIVAL_TIMESTAMP"	TIMESTAMP,
  "ARCHIVED_BY"	VARCHAR(255),
  "CLEARED"	SMALLINT,
  "CLEARED_BY"	VARCHAR(255),
  "CLEARED_TIMESTAMP"	TIMESTAMP,
  "EVENT_TIMESTAMP"	TIMESTAMP,
  "LOCATION"	INTEGER	NOT NULL,
  "VERSION"	INTEGER
);	
	
ALTER TABLE "STAMPSTOR"."ALARM_CONTACT_TBX"
  ADD CONSTRAINT "FKC5F8EA3D6681170C" FOREIGN KEY
    ("ALARM")
  REFERENCES "STAMPSTOR"."ALARMS_DEFINITION_TBX"
    ("ALARM_DEFINITION_ID")
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
    ENFORCED
    ENABLE QUERY OPTIMIZATION;

ALTER TABLE "STAMPSTOR"."ALARM_CONTACT_TBX"
  ADD CONSTRAINT "FKC5F8EA3D4BBA7177" FOREIGN KEY
    ("CONTACT")
  REFERENCES "STAMPSTOR"."CONTACT_TBX"
    ("CONTACT_ID")
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
    ENFORCED
    ENABLE QUERY OPTIMIZATION;

GRANT CONTROL ON TABLE "STAMPSTOR"."CONTACT_TBX" TO USER "OHCVAPRD";

GRANT CONTROL ON TABLE "STAMPSTOR"."ALARM_CONTACT_TBX" TO USER "OHCVAPRD";

GRANT SELECT, INSERT, UPDATE, ALTER, DELETE,
    INDEX, REFERENCES ON TABLE "STAMPSTOR"."CONTACT_TBX" TO USER "OHCVAPRD" WITH GRANT OPTION;
	
GRANT SELECT, INSERT, UPDATE, ALTER, DELETE,
    INDEX, REFERENCES ON TABLE "STAMPSTOR"."ALARM_CONTACT_TBX" TO USER "OHCVAPRD" WITH GRANT OPTION;

UPDATE "STAMPSTOR"."ALARMS_DEFINITION_TBX" SET VERSION = 0, ACTIVE = 1, AUTO_ARCHIVE_TIME = 2880.0, NOTIFICATION_REQUIRED = 0;
UPDATE "STAMPSTOR"."ALARMS_EVENT_TBX" SET VERSTION = 0;