<?xml version="1.0" encoding="UTF-8"?>

<beans:beans xmlns="http://www.springframework.org/schema/security"
             xmlns:beans="http://www.springframework.org/schema/beans"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xmlns:context="http://www.springframework.org/schema/context"
             xmlns:security="http://www.springframework.org/schema/security"
             xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
                        http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.0.xsd">
    <security:http auto-config="true" use-expressions="true">

        <form-login login-processing-url="/resources/j_spring_security_check" login-page="/login"
                    authentication-failure-url="/login?login_error=t"/>
        <logout logout-url="/resources/j_spring_security_logout"/>

        <!-- Configure these elements to secure URIs in your application -->
        <intercept-url pattern="/secure_welcome" access="isAuthenticated()"/>
        <intercept-url pattern="/stops/**" access="hasAnyRole('ROLE_APP-OHCVD-MAP-STADMIN', 'ROLE_APP-OHCVP-MAP-STADMIN', 'ROLE_APP-OHCVQ-MAP-STADMIN')"/>
        <intercept-url pattern="/dies/**" access="hasAnyRole('ROLE_APP-OHCVD-MAP-STADMIN', 'ROLE_APP-OHCVP-MAP-STADMIN', 'ROLE_APP-OHCVQ-MAP-STADMIN')"/>
        <intercept-url pattern="/models/**" access="hasAnyRole('ROLE_APP-OHCVD-MAP-STADMIN', 'ROLE_APP-OHCVP-MAP-STADMIN', 'ROLE_APP-OHCVQ-MAP-STADMIN')"/>
        <intercept-url pattern="/ordermgrs/**" access="hasAnyRole('ROLE_APP-OHCVD-MAP-STADMIN', 'ROLE_APP-OHCVP-MAP-STADMIN', 'ROLE_APP-OHCVQ-MAP-STADMIN')"/>
        <intercept-url pattern="/alarms/**" access="hasAnyRole('ROLE_APP-OHCVD-MAP-STADMIN', 'ROLE_APP-OHCVP-MAP-STADMIN', 'ROLE_APP-OHCVQ-MAP-STADMIN')"/>
        <intercept-url pattern="/weldorders/**" access="hasAnyRole('ROLE_APP-OHCVD-MAP-STADMIN', 'ROLE_APP-OHCVP-MAP-STADMIN', 'ROLE_APP-OHCVQ-MAP-STADMIN','ROLE_APP-OHCVD-MAP-TLCORD','ROLE_APP-OHCVQ-MAP-TLCORD','ROLE_APP-OHCVP-MAP-TLCORD','ROLE_APP-OHCVD-MAP-WEOP1','ROLE_APP-OHCVQ-MAP-WEOP1','ROLE_APP-OHCVP-MAP-WEOP1','ROLE_APP-OHCVD-MAP-WEOP2','ROLE_APP-OHCVQ-MAP-WEOP2','ROLE_APP-OHCVP-MAP-WEOP2','ROLE_APP-OHCVD-MAP-INSPECT','ROLE_APP-OHCVQ-MAP-INSPECT','ROLE_APP-OHCVP-MAP-INSPECT','ROLE_APP-OHCVD-MAP-SCHED','ROLE_APP-OHCVQ-MAP-SCHED','ROLE_APP-OHCVP-MAP-SCHED','ROLE_APP-OHCVD-MAP-MAINT','ROLE_APP-OHCVQ-MAP-MAINT','ROLE_APP-OHCVP-MAP-MAINT','ROLE_APP-OHCVD-MAP-STOP','ROLE_APP-OHCVQ-MAP-STOP','ROLE_APP-OHCVP-MAP-STOP')"/>
        <intercept-url pattern="/auditerrorlogs/**" access="hasAnyRole('ROLE_APP-OHCVD-MAP-STADMIN', 'ROLE_APP-OHCVP-MAP-STADMIN', 'ROLE_APP-OHCVQ-MAP-STADMIN','ROLE_APP-OHCVD-MAP-MAINT','ROLE_APP-OHCVQ-MAP-MAINT','ROLE_APP-OHCVP-MAP-MAINT')"/>
        <intercept-url pattern="/groupholds/**" access="hasAnyRole('ROLE_APP-OHCVD-MAP-STADMIN', 'ROLE_APP-OHCVP-MAP-STADMIN', 'ROLE_APP-OHCVQ-MAP-STADMIN', 'ROLE_APP-OHCVD-MAP-TLCORD', 'ROLE_APP-OHCVQ-MAP-TLCORD', 'ROLE_APP-OHCVP-MAP-TLCORD', 'ROLE_APP-OHCVD-MAP-STOP', 'ROLE_APP-OHCVQ-MAP-STOP', 'ROLE_APP-OHCVP-MAP-STOP', 'ROLE_APP-OHCVD-MAP-INSPECT', 'ROLE_APP-OHCVQ-MAP-INSPECT', 'ROLE_APP-OHCVP-MAP-INSPECT')"/>
        <intercept-url pattern="/alarmevents/**" access="hasAnyRole('ROLE_APP-OHCVD-MAP-STADMIN', 'ROLE_APP-OHCVP-MAP-STADMIN', 'ROLE_APP-OHCVQ-MAP-STADMIN','ROLE_APP-OHCVD-MAP-TLCORD','ROLE_APP-OHCVQ-MAP-TLCORD','ROLE_APP-OHCVP-MAP-TLCORD','ROLE_APP-OHCVD-MAP-WEOP1','ROLE_APP-OHCVQ-MAP-WEOP1','ROLE_APP-OHCVP-MAP-WEOP1','ROLE_APP-OHCVD-MAP-WEOP2','ROLE_APP-OHCVQ-MAP-WEOP2','ROLE_APP-OHCVP-MAP-WEOP2','ROLE_APP-OHCVD-MAP-INSPECT','ROLE_APP-OHCVQ-MAP-INSPECT','ROLE_APP-OHCVP-MAP-INSPECT','ROLE_APP-OHCVD-MAP-SCHED','ROLE_APP-OHCVQ-MAP-SCHED','ROLE_APP-OHCVP-MAP-SCHED','ROLE_APP-OHCVD-MAP-MAINT','ROLE_APP-OHCVQ-MAP-MAINT','ROLE_APP-OHCVP-MAP-MAINT','ROLE_APP-OHCVD-MAP-STOP','ROLE_APP-OHCVQ-MAP-STOP','ROLE_APP-OHCVP-MAP-STOP')"/>
        <intercept-url pattern="/resources/**" access="permitAll"/>
        <intercept-url pattern="/**" access="permitAll"/>

    </security:http>
    
    <security:ldap-server id="ldap"
                          url="ldap://am.mds.honda.com:389/"
                          manager-dn="CN=OHCVWEBPROD,OU=Non-Person,OU=Users,OU=HAM,OU=Engineering,OU=Honda Global,DC=am,DC=mds,DC=honda,DC=com"
                          manager-password="W!3jp7Xg"/>
    <security:authentication-manager>
        <security:ldap-authentication-provider server-ref="ldap"
                                               user-search-filter="(sAMAccountName={0})"
                                               user-search-base="OU=Office,OU=Users,OU=HAM,OU=Engineering,OU=Honda Global,DC=am,DC=mds,DC=honda,DC=com"
                                               group-search-base="OU=Global,OU=Groups,OU=HAM,OU=Engineering,OU=Honda Global,DC=am,DC=mds,DC=honda,DC=com"
                                               group-search-filter="(member={0})"
                                               >
        </security:ldap-authentication-provider>
    </security:authentication-manager>
</beans:beans>