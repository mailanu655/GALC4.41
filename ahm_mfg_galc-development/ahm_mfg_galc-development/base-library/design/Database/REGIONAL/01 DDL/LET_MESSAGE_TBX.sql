
------------------------------------------------
-- DDL Statements for Table "GALADM  "."LET_MESSAGE_TBX"
------------------------------------------------
 
DROP TABLE "GALADM  "."LET_MESSAGE_TBX";


CREATE TABLE "GALADM  "."LET_MESSAGE_TBX"  (
		  "MESSAGE_ID" BIGINT NOT NULL GENERATED BY DEFAULT AS IDENTITY (  
		    START WITH +1  
		    INCREMENT BY +1  
		    MINVALUE +1  
		    MAXVALUE +9223372036854775807  
		    NO CYCLE  
		    NO CACHE  
		    NO ORDER ) , 
		  "TERMINAL_ID" CHAR(3 OCTETS) NOT NULL , 
		  "MESSAGE_TYPE" CHAR(4 OCTETS) NOT NULL , 
		  "SPOOL_ID" INTEGER NOT NULL , 
		  "IP_ADDRESS" VARCHAR(32 OCTETS) , 
		  "PRODUCT_ID" VARCHAR(32 OCTETS) , 
		  "BUILD_CODE" VARCHAR(20 OCTETS) , 
		  "MAC_ADDRESS" VARCHAR(45 OCTETS) , 
		  "TOTAL_STATUS" VARCHAR(10 OCTETS) , 
		  "MESSAGE_HEADER" VARCHAR(16 OCTETS) , 
		  "MESSAGE_REPLY" VARCHAR(16 OCTETS) , 
		  "DURATION" DECIMAL(8,3) , 
		  "XML_MESSAGE_BODY" XML , 
		  "EXCEPTION_MESSAGE_BODY" CLOB(1048576 OCTETS) LOGGED NOT COMPACT , 
		  "ACTUAL_TIMESTAMP" TIMESTAMP NOT NULL , 
		  "CREATE_TIMESTAMP" TIMESTAMP , 
		  "UPDATE_TIMESTAMP" TIMESTAMP )   
		 IN "GALTBS8K1" INDEX IN "GALTBSIDX3"  
		 ORGANIZE BY ROW; 


-- DDL Statements for Primary Key on Table "GALADM  "."LET_MESSAGE_TBX"

ALTER TABLE "GALADM  "."LET_MESSAGE_TBX" 
	ADD CONSTRAINT "LET_MESSAGE_PK" PRIMARY KEY
		("MESSAGE_ID");



-- DDL Statements for Indexes on Table "GALADM  "."LET_MESSAGE_TBX"

SET SYSIBM.NLS_STRING_UNITS = 'SYSTEM';

CREATE INDEX "GALADM  "."LET_MESSAGE_I1" ON "GALADM  "."LET_MESSAGE_TBX" 
		("PRODUCT_ID" ASC)
		
		COMPRESS NO 
		INCLUDE NULL KEYS ALLOW REVERSE SCANS;

-- DDL Statements for Indexes on Table "GALADM  "."LET_MESSAGE_TBX"

SET SYSIBM.NLS_STRING_UNITS = 'SYSTEM';

CREATE INDEX "GALADM  "."LET_MESSAGE_I2" ON "GALADM  "."LET_MESSAGE_TBX" 
		("IP_ADDRESS" ASC,
		 "TERMINAL_ID" ASC)
		
		COMPRESS NO 
		INCLUDE NULL KEYS ALLOW REVERSE SCANS;

-- DDL Statements for Foreign Keys on Table "GALADM  "."LET_MESSAGE_TBX"

ALTER TABLE "GALADM  "."LET_MESSAGE_TBX" 
	ADD CONSTRAINT "LET_MESSAGE_FK1" FOREIGN KEY
		("SPOOL_ID")
	REFERENCES "GALADM  "."LET_SPOOL_TBX"
		("SPOOL_ID")
	ON DELETE NO ACTION
	ON UPDATE NO ACTION
	NOT ENFORCED
	TRUSTED
	ENABLE QUERY OPTIMIZATION;






-------------------------------
-- DDL Statements for Triggers
-------------------------------


SET SYSIBM.NLS_STRING_UNITS = 'SYSTEM';
SET CURRENT SCHEMA = "GALINST ";
SET CURRENT PATH = "SYSIBM","SYSFUN","SYSPROC","SYSIBMADM","GALINST";

DROP TRIGGER "GALADM  "."LET_MESSAGE_TR1";

CREATE TRIGGER "GALADM"."LET_MESSAGE_TR1"
  NO CASCADE BEFORE INSERT
  ON "GALADM"."LET_MESSAGE_TBX"
  REFERENCING 
    NEW AS A
  FOR EACH ROW
  SET CREATE_TIMESTAMP = CURRENT_TIMESTAMP;


SET SYSIBM.NLS_STRING_UNITS = 'SYSTEM';
SET CURRENT SCHEMA = "GALINST ";
SET CURRENT PATH = "SYSIBM","SYSFUN","SYSPROC","SYSIBMADM","GALINST";

DROP TRIGGER "GALADM  "."LET_MESSAGE_TR2";

CREATE TRIGGER "GALADM"."LET_MESSAGE_TR2"
  NO CASCADE BEFORE UPDATE
  ON "GALADM"."LET_MESSAGE_TBX"
  REFERENCING 
    NEW AS A
  FOR EACH ROW
  SET UPDATE_TIMESTAMP = CURRENT_TIMESTAMP;


