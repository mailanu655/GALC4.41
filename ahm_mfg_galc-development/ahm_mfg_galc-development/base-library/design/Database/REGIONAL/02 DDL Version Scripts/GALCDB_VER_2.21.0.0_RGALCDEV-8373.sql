DROP TRIGGER GALADM.OIF_RUN_HISTORY_TR2;
DROP TRIGGER GALADM.OIF_RUN_HISTORY_TR1;
DROP TABLE GALADM.OIF_RUN_HISTORY_TBX;

CREATE TABLE GALADM.OIF_RUN_HISTORY_TBX (
   RUN_HISTORY_ID 		BIGINT			NOT NULL 
     GENERATED BY DEFAULT
       AS IDENTITY (START WITH 1, INCREMENT BY 1, NO CACHE,
                    NO MINVALUE, NO MAXVALUE, NO CYCLE, NO ORDER),
   JOB_NAME				VARCHAR(40)		NOT NULL,
   START_TIMESTAMP		TIMESTAMP		NOT NULL,
   END_TIMESTAMP		TIMESTAMP		NOT NULL,
   STATUS			    VARCHAR(100)    NOT NULL,
   SUCCESS_COUNT 	    INTEGER			NOT NULL WITH DEFAULT 0 ,
   FAILED_COUNT         INTEGER			NOT NULL WITH DEFAULT 0 ,
   INCOMING_FILE_NAME   VARCHAR(256),
   LOCAL_FILE_NAME		VARCHAR(256),
   OUTGOING_FILE_NAME   VARCHAR(512),
   INTERFACE_ID		    VARCHAR(100)	,
   USER_NAME			VARCHAR(20),
   CREATE_TIMESTAMP		TIMESTAMP  NOT NULL WITH DEFAULT CURRENT_TIMESTAMP,
   UPDATE_TIMESTAMP		TIMESTAMP, 
   CONSTRAINT OIF_RUN_HISTORY_PK PRIMARY KEY 
     (RUN_HISTORY_ID)
)
  IN GALTBSREF12
  INDEX IN GALTBSIDX4;

ALTER TABLE GALADM.OIF_RUN_HISTORY_TBX
  DATA CAPTURE CHANGES
  PCTFREE 0
  LOCKSIZE ROW
  APPEND OFF
  NOT VOLATILE;

COMMENT ON TABLE GALADM.OIF_RUN_HISTORY_TBX IS 'RMT OIF_RUN_HISTORY_TBX is used to keep run information for each OIF instance run.';
    
CREATE TRIGGER GALADM.OIF_RUN_HISTORY_TR1
  NO CASCADE BEFORE INSERT
  ON GALADM.OIF_RUN_HISTORY_TBX
  REFERENCING 
    NEW AS A
  FOR EACH ROW
SET CREATE_TIMESTAMP=CURRENT_TIMESTAMP;

CREATE TRIGGER GALADM.OIF_RUN_HISTORY_TR2
  NO CASCADE BEFORE UPDATE
  ON GALADM.OIF_RUN_HISTORY_TBX
  REFERENCING 
    NEW AS A
  FOR EACH ROW
SET UPDATE_TIMESTAMP=CURRENT_TIMESTAMP;

