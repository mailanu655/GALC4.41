DROP TRIGGER GALADM.OP_EFFICIENCY_HIST_TR1;
DROP TRIGGER GALADM.OP_EFFICIENCY_HIST_TR2;
DROP TABLE GALADM.OP_EFFICIENCY_HIST_TBX;

DROP TRIGGER GALADM.MC_OP_EFFICIENCY_HIST_TR2;
DROP TRIGGER GALADM.MC_OP_EFFICIENCY_HIST_TR1;
DROP TABLE GALADM.MC_OP_EFFICIENCY_HIST_TBX;

CREATE TABLE GALADM.MC_OP_EFFICIENCY_HIST_TBX
(
	OP_EFFICIENCY_HIST_ID	BIGINT NOT NULL 
		GENERATED BY DEFAULT 
			AS IDENTITY (START WITH 1, INCREMENT BY 1, NO CACHE, NO MINVALUE, NO MAXVALUE, NO CYCLE, NO ORDER),
	PRODUCT_ID 				CHARACTER(17)  NOT NULL,
	HOST_NAME 				CHARACTER(32) DEFAULT '' NOT NULL,
	PROCESS_POINT_ID		CHARACTER(16)  NOT NULL,
	ASM_PROC_NO				VARCHAR(5)       NOT NULL,
	UNIT_NO					CHARACTER(6)   NOT NULL,
	UNIT_TOT_TIME			FLOAT NOT NULL WITH DEFAULT 0,
	START_TIMESTAMP			TIMESTAMP        NOT NULL,
	END_TIMESTAMP			TIMESTAMP        NOT NULL,
	ACTUAL_TIME				FLOAT NOT NULL WITH DEFAULT 0,
	STATUS					VARCHAR(20) NOT NULL,
	ASSOCIATE_NO			CHARACTER(11) NOT NULL,
	CREATE_TIMESTAMP		TIMESTAMP ,
	UPDATE_TIMESTAMP		TIMESTAMP,
	CONSTRAINT MC_OP_EFFICIENCY_HIST_PK PRIMARY KEY (OP_EFFICIENCY_HIST_ID)
)
  IN GALTBSDAT4
  INDEX IN GALTBSIDX3;

ALTER TABLE GALADM.MC_OP_EFFICIENCY_HIST_TBX  
  DATA CAPTURE CHANGES
  PCTFREE 0
  LOCKSIZE ROW
  APPEND OFF
  NOT VOLATILE;

COMMENT ON TABLE GALADM.MC_OP_EFFICIENCY_HIST_TBX IS 'RMT Keeps history of how long a unit of operation took at the process point';

CREATE TRIGGER GALADM.MC_OP_EFFICIENCY_HIST_TR1
  NO CASCADE BEFORE INSERT
  ON GALADM.MC_OP_EFFICIENCY_HIST_TBX
  REFERENCING
    NEW AS A
  FOR EACH ROW
SET CREATE_TIMESTAMP=CURRENT_TIMESTAMP;

CREATE TRIGGER GALADM.MC_OP_EFFICIENCY_HIST_TR2
  NO CASCADE BEFORE UPDATE
  ON GALADM.MC_OP_EFFICIENCY_HIST_TBX
  REFERENCING
    NEW AS A
  FOR EACH ROW
SET UPDATE_TIMESTAMP=CURRENT_TIMESTAMP;
